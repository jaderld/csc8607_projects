# Configuration complète pour le projet CIFAR-100 avec BottleneckNet

dataset:
  name: CIFAR100
  root: "./data"
  download: true
  num_workers: 4
  shuffle: true

preprocess:
  resize: null                       # images déjà 32x32, pas besoin de resize
  normalize:
    mean: [0.5071, 0.4867, 0.4408]  # mean des channels CIFAR-100
    std: [0.2675, 0.2565, 0.2761]   # std des channels CIFAR-100
  text_tokenizer: null

augment:
  random_flip: true
  random_crop:
    size: 32
    padding: 4
  color_jitter:
    brightness: 0.2
    contrast: 0.2
    saturation: 0.2
    hue: 0.1
  spec_augment: null

model:
  type: bottleneck_net
  num_classes: 100
  input_shape: [3, 32, 32]
  blocks: [2, 2, 2]       # (B1, B2, B3)
  bottleneck_mid: 16       # facteur goulot pour stage 1
  activation: relu
  dropout: 0.0
  batch_norm: true
  residual: true
  attention: false
  rnn:
    type: null
    hidden_size: null
    num_layers: null
    bidirectional: false

train:
  seed: 42
  device: auto
  batch_size: 64
  epochs: 50
  max_steps: null
  overfit_small: false

  optimizer:
    name: adam
    lr: 0.001
    weight_decay: 0.0005
    momentum: 0.9

  scheduler:
    name: none
    step_size: 10
    gamma: 0.1
    warmup_steps: 0

metrics:
  classification:
    - accuracy
  regression: []

hparams:
  lr: [0.0005, 0.001, 0.005]
  batch_size: [32, 64]
  weight_decay: [0.0, 0.0005]

paths:
  runs_dir: "./runs"
  artifacts_dir: "./artifacts"
