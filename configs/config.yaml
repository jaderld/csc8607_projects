# =========================================================
# Configuration complète — CIFAR-100 + BottleneckNet
# =========================================================

dataset:
  name: CIFAR100
  root: "./data"
  download: true
  num_workers: 4
  shuffle: true

# ---------------------------------------------------------
# Prétraitement
# ---------------------------------------------------------
preprocess:
  resize: null
  normalize:
    mean: [0.5071, 0.4867, 0.4408]
    std:  [0.2675, 0.2565, 0.2761]
  text_tokenizer: null

# ---------------------------------------------------------
# Augmentation (désactivée pour expériences principales)
# ---------------------------------------------------------
augment:
  random_flip: true
  random_crop:
    size: 32
    padding: 4
  color_jitter:
    brightness: 0.2
    contrast: 0.2
    saturation: 0.2
    hue: 0.1
  spec_augment: null

# ---------------------------------------------------------
# Modèle
# ---------------------------------------------------------
model:
  type: bottleneck_net
  num_classes: 100
  input_shape: [3, 32, 32]

  # Valeurs par défaut (utilisées hors grid search)
  blocks: [2, 2, 2]
  bottleneck_mid: 16

  activation: relu
  dropout: 0.0
  batch_norm: true
  residual: true
  attention: false

  rnn:
    type: null
    hidden_size: null
    num_layers: null
    bidirectional: false

# ---------------------------------------------------------
# Entraînement
# ---------------------------------------------------------
train:
  seed: 42
  device: auto
  batch_size: 64
  epochs: 50
  max_steps: null
  overfit_small: false

  optimizer:
    name: adam
    lr: 0.001
    weight_decay: 0.0005
    momentum: 0.9

  scheduler:
    name: none
    step_size: 10
    gamma: 0.1
    warmup_steps: 0

# ---------------------------------------------------------
# Métriques
# ---------------------------------------------------------
metrics:
  classification:
    - accuracy
  regression: []

# ---------------------------------------------------------
# Mini Grid Search
# ---------------------------------------------------------
hparams:
  lr: [0.0002, 0.001]
  weight_decay: [0.0, 0.0005]
  blocks: [[2,2,2], [3,3,3]]
  bottleneck_mid: [16, 32]

grid:
  epochs: 5   # entraînements courts pour la recherche

# ---------------------------------------------------------
# Chemins
# ---------------------------------------------------------
paths:
  runs_dir: "./runs"
  artifacts_dir: "./artifacts"
